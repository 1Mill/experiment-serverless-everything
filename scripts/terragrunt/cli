#!/usr/bin/env bash
set -e

function cli() {
	# * Props
	local command=${@:1}

	# * Computed values
	local terraform_versions_dir="$(dirname $BASH_SOURCE)/../../terraform-versions/"
	local files=$(find $terraform_versions_dir -type f -exec basename {} ";")

	for file in $files
	do
		local version=$(sed "s/[^0-9.]*//g" $terraform_versions_dir/$file)
		local image="alpine/terragrunt:${version}"

		source $(dirname $BASH_SOURCE)/commands/run $image $command --terragrunt-modules-that-include terraform-versions/$file
	done
}

cli ${@:1} # * Pass through all arguments to function
