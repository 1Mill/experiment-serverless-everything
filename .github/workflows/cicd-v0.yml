name: CICD V0

on:
  push:
    branches:
      - main

defaults:
  run:
    shell: bash

env:
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  AWS_REGION: ca-central-1
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checking out code ...
        uses: actions/checkout@v3
      - name: Gaining permission to read and execute all files ...
        run: |
          find . \
            -not -path "*dist/*" \
            -not -path "*node_modules/*" \
            -not -path "*terraform*" \
            -type f \
            -exec chmod 544 {} +
      - name: Running hello-world script ...
        run: ./testing-cicd.bash
